# Windows kernel

Uncategorized

* [am0nsec/wkpe - Windows Kernel Programming Experiments](https://github.com/am0nsec/wkpe)
* [Fyyre/DrvMon - Advanced driver monitoring utility](https://github.com/Fyyre/DrvMon)
* [mattifestation/AntimalwareBlight - Execute PowerShell code at the antimalware-light protection level](https://github.com/mattifestation/AntimalwareBlight)
   * https://gist.github.com/CaledoniaProject/64cf487b11044ec419445f2ebab6635f
* [KANKOSHEV/Detect-HiddenThread-via-KPRCB - Detect removed thread from PspCidTable](https://github.com/KANKOSHEV/Detect-HiddenThread-via-KPRCB)
* [VoidSec/ioctlpus - IOCTLpus can be used to make DeviceIoControl requests with arbitrary inputs (with functionality somewhat similar to Burp Repeater) - 内核ioctl调试工具，基于.NET 4.6编写](https://github.com/VoidSec/ioctlpus)
* [Kharos102/IOCTLDump - a driver that can be used for hooking and dumping IOCTLS (including FastIO & RW interactions) of other device drivers](https://github.com/Kharos102/IOCTLDump)
* [smallzhong/hide_execute_memory - 隐藏可执行内存](https://github.com/smallzhong/hide_execute_memory)
* [VollRagm/KernelBypassSharp - C# Kernel Mode Driver to read and write memory in protected processes - C#实现驱动的例子](https://github.com/VollRagm/KernelBypassSharp)
* [qq1045551070/ShotHv - 个人编写的精简版X64虚拟化框架, 实现了R0 EPT HOOK, 已在 Win7、Win10 1809、Win 1909 真机环境测试](https://github.com/qq1045551070/ShotHv)
* [Deputation/kernel_sockets_memory - Kernel-based memory hacking framework communicating with a kernel driver via sockets](https://github.com/Deputation/kernel_sockets_memory)
* [uf0o/windows-ps-callbacks-experiments - 在内核里删除AV驱动的回调](https://github.com/uf0o/windows-ps-callbacks-experiments)
* [w1u0u1/kt - Kernel file/process/object tool - 很好的代码参考](https://github.com/w1u0u1/kt)
* [amiryeshurun/HyperWin - A native hypervisor designed for the Windows operating system](https://github.com/amiryeshurun/HyperWin)
* [0xfei/wincode - 过去写的一些Windows安全研究相关代码 - RING0/RING3的都有，先放到内核这里了](https://github.com/0xfei/wincode)
* [rabbitstack/fibratus - A modern tool for the Windows kernel exploration and tracing](https://github.com/rabbitstack/fibratus)
* [zodiacon/SystemExplorer - Windows System Explorer](https://github.com/zodiacon/SystemExplorer)
* [yardenshafir/DpcWait - Driver demonstrating how to register a DPC to asynchronously wait on an object](https://github.com/yardenshafir/DpcWait)
* [MartinDrab/IRPMon - The goal of the tool is to monitor requests received by selected device objects or kernel drivers. The tool is quite similar to IrpTracker but has several enhancements](https://github.com/MartinDrab/IRPMon)
* [misc0110/PTEditor - A small library to modify all page-table levels of all processes from user space for x86_64 and ARMv8](https://github.com/misc0110/PTEditor)
* [alxbrn/kernel-injector - Kernel Injector pasted from various different Github repositories](https://github.com/alxbrn/kernel-injector)
* [wbenny/injdrv - Windows Driver for injecting DLL into user-mode processes using APC - 未测试，说是全版本Windows支持](https://github.com/wbenny/injdrv)
  * [Bypassing the Microsoft-Windows-Threat-Intelligence Kernel APC Injection Sensor - ATP 已经有监控了，这里介绍了一些绕过思路，以及微软官方是怎么发现的，没仔细看](https://medium.com/@philiptsukerman/bypassing-the-microsoft-windows-threat-intelligence-kernel-apc-injection-sensor-92266433e0b0)
* [SinaKarvandi/Misc - ObRegisterCallbacks 监控进程创建，TypeInfoCallbacksHooker 查找钩子](https://github.com/SinaKarvandi/Misc)
* [ciyze/Windows-Rootkits](https://github.com/ciyze/Windows-Rootkits)
* [yardenshafir/SymlinkCallback - tree/part-two - uses the option to set a dynamic target for a symbolic link and hooks the symlink of the C: volume](https://github.com/yardenshafir/SymlinkCallback/tree/part-two)
* [DavidXanatos/IgnoreACLs - A driver to make windows ignore Access Control when accessing files](https://github.com/DavidXanatos/IgnoreACLs)
* [Professor-plum/Reflective-Driver-Loader - a injection technique base off Reflective DLL injection by Stephen Fewer.](https://github.com/Professor-plum/Reflective-Driver-Loader)
* [nsacyber/Driver-Collider - Blocks drivers from loading by using a name collision technique](https://github.com/nsacyber/Driver-Collider)
* [SouhailHammou/Drivers - Windows drivers I wrote](https://github.com/SouhailHammou/Drivers)
* [yangruiqiyr/Syscall-Monitor - 一个用Intel VT-X/EPT实现的类似Sysinternal's Process Monitor的工具。现已迁移至QT框架，支持32位/64位Windows 7及以上系统](https://github.com/yangruiqiyr/Syscall-Monitor)
* [isoadam/gina_public - Prototype of hijacking Windows driver dispatch routines in unmapped discardable sections](https://github.com/isoadam/gina_public)
* [OSRDrivers/kmexts - Simple driver to register all available process, thread, image, Registry, and Object callbacks](https://github.com/OSRDrivers/kmexts)
* [d35ha/xKeLogger - Kernel mode windows NT API logger](https://github.com/d35ha/xKeLogger)
* [0xcpu/ExecutiveCallbackObjects - Research on Windows Kernel Executive Callback Objects](https://github.com/0xcpu/ExecutiveCallbackObjects)
* [Gbps/gbhv - Simple x86-64 VT-x Hypervisor with EPT Hooking](https://github.com/Gbps/gbhv)
* [supermanc88/KeyboardEncrypt - 键盘加密传输](https://github.com/supermanc88/KeyboardEncrypt)
* [zhuhuibeishadiao/JunkDriveOpenSource - Some garbage drivers written for getting started](https://github.com/zhuhuibeishadiao/JunkDriveOpenSource)
* [0vercl0k/kdmp-parser - Windows kernel dump C++ parser](https://github.com/0vercl0k/kdmp-parser)
* [HoShiMin/Kernel-Bridge - Windows kernel hacking framework, driver template, hypervisor and API written on C++](https://github.com/HoShiMin/Kernel-Bridge)
* [raminfp/basicwindowskernelprogramming - Basic Windows Kernel Programming - shellcode执行、c++ string使用、json解析、内存分配、线程创建等等](https://github.com/raminfp/basicwindowskernelprogramming)
* [Truneski/WindowsKernelProgramming-Exercises - 包含文件防删、注册表保护、进程创建监控三个例子](https://github.com/Truneski/WindowsKernelProgramming-Exercises)
* [zodiacon/KernelExplorer](https://github.com/zodiacon/KernelExplorer)
* [can1357/NtLua - Lua in kernel-mode because why not](https://github.com/can1357/NtLua)
* [thesecretclub/callout-poc - an example proof-of-concept of callout threads and the callout mechanism - 伪造调用堆栈](https://github.com/thesecretclub/callout-poc)

Syscalls

* [j00ru/windows-syscalls - Windows System Call Tables (NT/2000/XP/2003/Vista/2008/7/2012/8/10)](https://github.com/j00ru/windows-syscalls)
* [joshfinley/SyscallDumper - Dump system call codes, names, and offsets given a local ntdll.dll file](https://github.com/joshfinley/SyscallDumper)

Hook

* [SHA-MRIZ/DisplayMiniportHooking - Display Miniport Hooking - 这个的意义是什么？](https://github.com/SHA-MRIZ/DisplayMiniportHooking)
* [everdox/InfinityHook - Hook system calls, context switches, page faults and more - 基于etw hook方式实现内核syscall hook，W10 1909之后GetCpuClock不能用了](https://github.com/everdox/InfinityHook)
  * [FiYHer/InfinityHookPro - 微调版本，支持到W11](https://github.com/FiYHer/InfinityHookPro)

HVCI

* [Cr4sh/KernelForge - A library to develop kernel level Windows payloads for post HVCI era](https://github.com/Cr4sh/KernelForge)

Process

* [landhb/HideProcess - A basic Direct Kernel Object Manipulation rootkit that removes a process from the EPROCESS list, hiding it from the Task Manager](https://github.com/landhb/HideProcess)
* [devoteam-fr/CERT/tree/master/kernel_process_hiding](https://github.com/devoteam-fr/CERT/tree/master/kernel_process_hiding)
* [thibaultmeyer/deadlands-windows-dkom - Windows DKOM : Hide Processus - 2012停更](https://github.com/thibaultmeyer/deadlands-windows-dkom)
* [fdiskyou/windows-ps-callbacks-experiments - ps 回调监控例子](https://github.com/fdiskyou/windows-ps-callbacks-experiments)
* [zerosum0x0/SassyKitdi - Kernel Mode TCP Sockets + LSASS Dump (Rust Shellcode)](https://github.com/zerosum0x0/SassyKitdi)

File system

* [hkx3upper/FOKS-TROT - minifilter双缓冲透明加解密过滤驱动](https://github.com/hkx3upper/FOKS-TROT)
* [shubham0d/SymBlock - A windows kernel driver to Block symbolic link exploit used for privilege escalation](https://github.com/shubham0d/SymBlock)
* [SHA-MRIZ/FsMinfilterHooking - Part 1: Fs Minifilter Hooking POC](https://github.com/SHA-MRIZ/FsMinfilterHooking)
* [billziss-gh/winfsp - Windows File System Proxy - FUSE for Windows](https://github.com/billziss-gh/winfsp)
* [xiao70/X70FSD - Windows file system filter drivers(minifilter) to encrypt, compress, or otherwise modify file-based data require some of the most complex kernel software developed for Windows](https://github.com/xiao70/X70FSD)
* [sgabe/SymlinkProtect - File system minifilter driver for Windows to block symbolic link attacks](https://github.com/sgabe/SymlinkProtect)

Networking

* [wbenny/ksocket - KSOCKET provides a very basic example how to make a network connections in the Windows Driver by using WSK](https://github.com/wbenny/ksocket)

Cheating

* [BeneficialCode/Game-Cheating-Tutorial - 热门网络游戏辅助开发教程](https://github.com/BeneficialCode/Game-Cheating-Tutorial)
* [alxbrn/rccom-leak - Rainbow Six Siege & Apex Legends source leak from risecheats.com - 写个驱动修改内存，然后就绕过反作弊了](https://github.com/alxbrn/rccom-leak)
  * [mrexodia/TitanHide - Hiding kernel-driver for x86/x64](https://github.com/mrexodia/TitanHide)

Patchguard

* [HyperSine/Windows10-CustomKernelSigners - Load self-signed drivers without TestSigning or disable DSE - 仅供测试，感觉没啥用](https://github.com/HyperSine/Windows10-CustomKernelSigners)
* [Mattiwatti/EfiGuard - Disable PatchGuard and DSE at boot time](https://github.com/Mattiwatti/EfiGuard)
* [can1357/ByePg - Defeating Patchguard universally for Windows 8, Windows 8.1 and all versions of Windows 10 regardless of HVCI](https://github.com/can1357/ByePg)
* [KiFilterFiberContext/warbird-hook - Using Microsoft Warbird to automatically unpack and execute encrypted shellcode in ClipSp.sys without triggering PatchGuard](https://github.com/KiFilterFiberContext/warbird-hook)
* [kkent030315/NoPatchGuardCallback - x64 Windows PatchGuard bypass, register process-creation callbacks from unsigned code - 博客是日语的](https://github.com/kkent030315/NoPatchGuardCallback)
* [zhuhuibeishadiao/PatchGuardResearch - win10 PatchGuard 动态解密(btc版本)](https://github.com/zhuhuibeishadiao/PatchGuardResearch)
* [9176324/Shark - Turn off PatchGuard in real time for win7 (7600) ~ later](https://github.com/9176324/Shark)
* [Updated Analysis of PatchGuard on Microsoft Windows 10 RS4](https://blog.tetrane.com/downloads/Tetrane_PatchGuard_Analysis_RS4_v1.01.pdf)

DSE Bypass

* [hfiref0x/KDU - The purpose of this tool is to give a simple way to explore Windows kernel/components without doing a lot of additional work or setting up local debugger - 有14个内置驱动](https://github.com/hfiref0x/KDU)
* [SamLarenN/CPUZ-DSEFix - Exploiting CPU-Z Driver To Turn Load Unsigned Drivers](https://github.com/SamLarenN/CPUZ-DSEFix)
* [hfiref0x/TDL - Driver loader for bypassing Windows x64 Driver Signature Enforcement](https://github.com/hfiref0x/TDL)
* [hfiref0x/UPGDSED - Universal PatchGuard and Driver Signature Enforcement Disable](https://github.com/hfiref0x/UPGDSED)
* [hfiref0x/DSEFix - Windows x64 Driver Signature Enforcement Overrider - 测试到2019全补丁版本都有效。完善的方案需要同时Patch BSOD handler，并禁用 Program Compatibility Assistant (PcaSvc) 服务，这个程序没有做；mcafee 会拦截这个驱动](https://github.com/hfiref0x/DSEFix)
* [pyj2323/dsefix - Windows x64 Driver Signature Enforcement Overrider - 这个没签名居然能加载，WTF？](https://github.com/pyj2323/dsefix)
* [airbus-seclab/warbirdvm - An analysis of the Warbird virtual-machine protection for the CI!g_pStore](https://github.com/airbus-seclab/warbirdvm)
* [shjalayeri/DriveCrypt - DriveCrypt Dcr.sys vulnerability exploit for bypassing x64 DSE](https://github.com/shjalayeri/DriveCrypt)
* [alxbrn/gdrv-loader - Kernel driver loader using vulnerable gigabyte driver - 用 GMEMCPY 接口读写内存](https://github.com/alxbrn/gdrv-loader)
* [CVE-2020–14979: Local Privilege Escalation in EVGA Precision X1 - WinRing0 带签名，读写内存、读写端口，驱动官网还有](https://posts.specterops.io/cve-2020-14979-local-privilege-escalation-in-evga-precisionx1-cf63c6b95896)
* [xpnsec: g_CiOptions in a Virtualized World](https://blog.xpnsec.com/gcioptions-in-a-virtualized-world/)

Signed driver abuse

* https://github.com/alfarom256/drivers_and_shit
* [br-sn/CheekyBlinder - Enumerating and removing kernel callbacks using signed vulnerable drivers - 这个用的是PPLKiller那个驱动](https://github.com/br-sn/CheekyBlinder)
* [ioncodes/ceload - Loading dbk64.sys and grabbing a handle to it](https://github.com/ioncodes/ceload)
* [Yaxser/Backstab - ProcExp has a signed kernel driver that it loads on startup, which allows it to kill handles that cannot be killed even as an administrator. When you use the UI, you cannot kill a protected process, but you can kill it handles because ProcExp UI instructs the kernel driver to kill those handles. Backstab does the same thing but without the UI element](https://github.com/Yaxser/Backstab)
* [RedSection/OffensivePH - use old Process Hacker driver to bypass several user-mode access controls - 可以在内核里获取进程HANDLE，绕过各种限制](https://github.com/RedSection/OffensivePH)
* [xeroxz/hmdm - Highly Modular Driver Mapper - 内置gdrv/CorsairLLAccess两个驱动](https://githacks.org/_xeroxz/hmdm)
* [mq1n/VDM - A library to manipulate drivers exposing a physical memory read/write primitive to allow the user to call any function in the kernel - 是个框架，默认仅支持gdrv](https://github.com/mq1n/VDM)
* [WinDivert - 有签名的内核驱动，支持抓包/改包/丢弃包，可以用来屏蔽AV联网](https://www.reqrypt.org/windivert.html)
  * [TechnikEmpire/WinDivertSharp - A minimal .NET binding over WinDivert](https://github.com/TechnikEmpire/WinDivertSharp)
  * [jellever/StreamDivert - Redirecting (specific) TCP, UDP and ICMP traffic to another destination](https://github.com/jellever/StreamDivert)
* [ProcessHacker - 支持 ZwTerminateProcess、读取任意进程内存，签名是2016年的](https://github.com/processhacker/processhacker/blob/master/KProcessHacker/devctrl.c)
* [huoji120/GpuzMaper - using gpuz to load driver](https://github.com/huoji120/GpuzMaper)
* [realoriginal/ppdump-public - Protected Process (Light) Dump: Uses Zemana AntiMalware Engine To Open a Privileged Handle to a PP/PPL Process And Inject MiniDumpWriteDump() Shellcode](https://github.com/realoriginal/ppdump-public)
* [rbapat/KStealthInjector - Stealthy Injector that leverages a vulnerable driver and other exploits to remain undetected - 代码里有驱动，可以OpenProcess；驱动2018年的，名称 xhunter/XIGNCODE3](https://github.com/rbapat/KStealthInjector)
* [iPower/KasperskyHook - Hook system calls on Windows by using Kaspersky's hypervisor - 不是用来加载任意驱动的](https://github.com/iPower/KasperskyHook)
* [z175/kdmapper - driver manual mapper - 内置 Intel iQVW64 驱动](https://github.com/z175/kdmapper)
  * [TheCruZ/kdmapper-1803-2004 - Updated kdmapper for the new 2004 windows version](https://github.com/TheCruZ/kdmapper-1803-2004)
* [VollRagm/lpmapper - A mapper that maps shellcode into loaded large page drivers](https://github.com/VollRagm/lpmapper)

Capcom

* [tandasat/ExploitCapcom - a standalone exploit for a vulnerable feature in Capcom.sys](https://github.com/tandasat/ExploitCapcom)
* [notscimmy/libcapcom - Capcom driver exploit wrapper](https://github.com/notscimmy/libcapcom)
* [FuzzySecurity/Capcom-Rootkit - Capcom Rootkit Proof-Of-Concept](https://github.com/FuzzySecurity/Capcom-Rootkit)
* [ihack4falafel/OSEE - Kernel Exploitation/Capcom](https://github.com/ihack4falafel/OSEE/tree/master/Kernel%20Exploitation/Capcom)

PPL

* [MartinIngesen/TokenStomp - C# implementation of the token privilege removal flaw discovered by @GabrielLandau/Elastic - 可以清空目标进程的权限，让EDR无法进行监控](https://github.com/MartinIngesen/TokenStomp)
  * [Allevon412/PPL_Sandboxer - a PoC to sandbox AV products by reducing their security tokens to an "untrusted level". Making it so they cannot interact with the host system - 同上，C++和syscall实现](https://github.com/Allevon412/PPL_Sandboxer)
* [itm4n/PPLdump - Dump the memory of a PPL with a userland exploit - 绕过PPL进程保护，注入DLL实现minidump](https://github.com/itm4n/PPLdump)
* [Mattiwatti/PPLKiller - Protected Processes Light Killer - 驱动要自己编译](https://github.com/Mattiwatti/PPLKiller)
  * [gijsh/PPLKiller@feature-allow-ppl-protection: 增加了/enablePPL参数，可以将已存在进程提升到PPL级别](https://github.com/gijsh/PPLKiller/tree/feature-allow-ppl-protection)
* [seebug: Protected Process Light (PPL) Attack](https://paper.seebug.org/1892/)

Exploits

* [SecIdiot/ANGRYORCHARD - exploiting the NtUserHardErrorControl call to achieve arbitrary R/W on Microsoft Windows 7 to 11. The bug itself works on all versions of Windows 7 to 11, and on newer editions of Windows is no longer easily reachable without third-party issues due to the servicing of the KnownDLLs bug described by James Forshaw and PoC developed by itm4n in July of 2022 - 这个是SYSTEM获取内核权限的方案](https://github.com/SecIdiot/ANGRYORCHARD)
* [eclypsium/Screwed-Drivers/DRIVERS.md - "Screwed Drivers" centralized information source for code references - 只有sha256，需要从VT下载](https://github.com/eclypsium/Screwed-Drivers/blob/master/DRIVERS.md)
* [FULLSHADE/Kernel-exploits - Windows kernel driver exploits](https://github.com/FULLSHADE/Kernel-exploits)
* [hoangprod/DanSpecial - Weaponizing Gigabyte driver for priv escalation and bypass PPL - 源代码里嵌入了驱动](https://github.com/hoangprod/DanSpecial)
* [DoubleLabyrinth/SdoKeyCrypt-sys-local-privilege-elevation - SdoKeyCrypt.sys - Local Privilege Elevation Vulnerability - 只是POC，带驱动文件](https://github.com/DoubleLabyrinth/SdoKeyCrypt-sys-local-privilege-elevation)
* [Barakat/CVE-2019-16098 - Local privilege escalation PoC exploit for CVE-2019-16098](https://github.com/Barakat/CVE-2019-16098)
* [CaledoniaProject/vulnerable-drivers-no-exp](https://github.com/CaledoniaProject/vulnerable-drivers-no-exp)
* [uf0o/CVE-2020-17382](https://github.com/uf0o/CVE-2020-17382)
   * [Kernel exploitation: weaponizing CVE-2020-17382 MSI Ambient Link driver](https://www.matteomalvica.com/blog/2020/09/24/weaponizing-cve-2020-17382/)
   * [MSI Ambient Link Multiple Vulnerabilities](https://www.coresecurity.com/core-labs/advisories/msi-ambient-link-multiple-vulnerabilities)
* [acru3l/PoC/CVE-2020-5617 - SKYSEA驱动空指针利用，有驱动文件](https://github.com/acru3l/PoC/tree/master/CVE-2020-5617)
   * [Exploiting SKYSEA Activity Monitor](https://acru3l.github.io/2020/08/03/exploiting-activity-monitor-driver/)

# Resources

* [Bypassing Image Load Kernel Callbacks](https://www.mdsec.co.uk/2021/06/bypassing-image-load-kernel-callbacks/)
